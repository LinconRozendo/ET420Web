import dash
from dash import dcc
from dash import html
from dash.dependencies import Input, Output
import dash_bootstrap_components as dbc
import dash_trich_components as dtc
from flask import Flask
from app import app
import pyautogui
from dash.exceptions import PreventUpdate
import os

os.environ['DISPLAY'] = ':0'


layout = html.Div([
    dcc.Location(id='url', refresh=False),
    html.Div([
        #cabe√ßalho
        html.Div([
            html.Img(
                src="./assets/images/logo_cear (1).png",
                id='dash_press_logo5_station',
                className="risk-reward",
            ),
            html.Div([
                html.H2(
                    "Bancada de Refrigera√ß√£o ET 420",
                    id='dash_press_txt1_station',
                    className="subtitle padded",
                ),
            ], id='divTitleBancada'),
            html.Img(
                src="./assets/images/logo_ufpb.png",
                id='dash_press_logo6_station',
            )
        ], style={'border-bottom': '5px blue solid',
                    'width': '100%',
                    'border-radius': '17px',
                    'background-color': 'lightgray'}, id='menuFlona'),
        ########################
        html.Div([
            dbc.Button("Home", color="primary", size="lg", className="me-1", id='buttonHome', n_clicks=0),
        ], style={'border-bottom': '3px blue solid',
                    'width': '100%',
                    'float': 'left',
                    'margin-bottom': '20px',
                    'height': '80px',
                    'border-radius': '15px',
                    'background': 'slategray'}),
        ########################
        #dashcards que redirecionam para os dash indicados  
        html.Div([
            html.H1(
                "Componentes",
                id='h1Title'
            ),
            html.H2(
                "Explore de forma concisa o funcionamento dos componentes fundamentais do Acumulador de Gelo e Refrigera√ß√£o ET 420\
                     nesta se√ß√£o. Descubra informa√ß√µes essenciais sobre os componentes presentes na bancada de refrigera√ß√£o e seu papel no\
                         sistema.",               
                id='h2ComponentesIntro',
            ),
            html.H1(
                "Bomba de Circula√ß√£o",
                id='h1NomeComponentes'
            ),
            html.Div([
                html.H2(
                    "As bombas de circula√ß√£o s√£o dispositivos fundamentais para movimentar l√≠quidos ou gases em sistemas fechados, gerando\
                     fluxo e facilitando a circula√ß√£o do fluido. Elas desempenham um papel essencial em uma variedade de aplica√ß√µes, como\
                         sistemas de aquecimento, ventila√ß√£o e ar condicionado, refrigera√ß√£o, abastecimento de √°gua em resid√™ncias e edif√≠cios,\
                             sistemas de irriga√ß√£o agr√≠cola, entre outros.",               
                    id='h2ModoCarga',
                ),
                html.Div([
                    html.Img(
                                src="./assets/images/bomba_circulacao.png",
                                id='components#fig',
                            ),
                    html.H5(
                                ["Bomba de Circula√ß√£o."], 
                                className="legendaImg",
                                style={
                                    "text-align": "center",
                                },
                            ),
                ], id='ImgComponentes'),
                html.H2(
                    "Essas bombas operam convertendo energia mec√¢nica em energia hidr√°ulica, gerando press√£o que impulsiona o fluido atrav√©s\
                         de tubula√ß√µes ou canais espec√≠ficos. Existem diversos tipos de bombas de circula√ß√£o, incluindo bombas centr√≠fugas,\
                             de deslocamento positivo e de fluxo axial, cada uma com suas caracter√≠sticas e aplica√ß√µes particulares.",               
                    id='h2ModoCarga',
                ),
                html.H2(
                    "Na bancada ET 420, encontramos as seguintes bombas: ",               
                    id='h2ModoCarga',
                ),
                html.H2(
                    "P1: Circula o fluido que passa pela torre de resfriamento seca e pelo est√°gio intermedi√°rio;",               
                    id='h2ModoCargaList',
                ),
                html.H2(
                    "P2: Circula a mistura √°gua-propileno glicol que passa pelo tanque de gelo e pelo sistema de resfriamento;",                
                    id='h2ModoCargaList',
                ),
                html.H2(
                    "P3: Circular o fluido que passa antes do est√°gio intermedi√°rio e pelo trocador de calor ùëä7;",                
                    id='h2ModoCargaList',
                ),
                html.H2(
                    "P4: Circular a √°gua que passa pela torre de resfriamento √∫mida.",                
                    id='h2ModoCargaList',
                )
            ], id='components#fig'),      
            #########################################
            html.H1(
                "Compressor",
                id='h1NomeComponentes'
            ),
            html.Div([
                html.H2(
                    "O compressor √© um dispositivo projetado para aumentar a press√£o de um fluido, seja l√≠quido ou g√°s, operando pela\
                         redu√ß√£o do volume do fluido. Isso √© alcan√ßado atrav√©s da remo√ß√£o de part√≠culas de ar ou g√°s para aumentar sua\
                             densidade e, consequentemente, sua press√£o. Os compressores s√£o amplamente utilizados em uma variedade de\
                                 aplica√ß√µes industriais, comerciais e dom√©sticas, incluindo compressores de ar em ferramentas pneum√°ticas,\
                                     compressores de g√°s em processos industriais e sistemas de refrigera√ß√£o.",               
                    id='h2ModoCarga',
                ),
                html.Div([
                    html.Img(
                                src="./assets/images/compressor.png",
                                id='components#fig',
                            ),
                    html.H5(
                                ["Compressor."], 
                                className="legendaImg",
                                style={
                                    "text-align": "center",
                                },
                            ),
                ], id='ImgComponentes'),
                html.H2(
                    "Na bancada ET 420, um compressor de pist√£o acionado eletricamente (V) √© utilizado para comprimir o fluido de trabalho\
                         vaporizado. Esta unidade √© totalmente herm√©tica, com o motor el√©trico e o compressor alojados em um inv√≥lucro soldado\
                             √† prova de g√°s.",               
                    id='h2ModoCarga',
                ),
            ], id='components#fig'),  
            ############################################################
            html.H1(
                "Condensador",
                id='h1NomeComponentes'
            ),
            html.Div([
                html.H2(
                    "O condensador desempenha um papel crucial nos sistemas de ar condicionado e refrigeradores, removendo calor do\
                         sistema. Ele recebe o refrigerante na forma de vapor de alta press√£o e alta temperatura, proveniente do compressor,\
                             e tem como objetivo condensar esse vapor refrigerante de volta ao estado l√≠quido, liberando calor para o ambiente.\
                                 Essencial para o funcionamento eficiente dos sistemas de refrigera√ß√£o, o condensador √© respons√°vel por remover\
                                     o calor do refrigerante, permitindo que o ciclo de refrigera√ß√£o prossiga.",               
                    id='h2ModoCarga',
                ),
                html.Div([
                    html.Img(
                                src="./assets/images/Condensador.jpg",
                                id='components#fig',
                            ),
                    html.H5(
                                ["Condensador."], 
                                className="legendaImg",
                                style={
                                    "text-align": "center",
                                },
                            ),
                ], id='ImgComponentes'),
                html.H2(
                    "Existem diferentes tipos de condensadores usados em sistemas de refrigera√ß√£o:",               
                    id='h2ModoCarga',
                ),
                html.H2(
                    "Condensador a ar: o calor do refrigerante √© transferido para o ar ambiente, resfriando-o sobre as bobinas do condensador;",               
                    id='h2ModoCargaList',
                ),
                html.H2(
                    "Condensador a √°gua: a √°gua √© usada como meio de resfriamento, resfriando o refrigerante que circula dentro do condensador;",                
                    id='h2ModoCargaList',
                ),
                html.H2(
                    "Condensador evaporativo: o processo de evapora√ß√£o da √°gua √© utilizado para resfriar o refrigerante, evaporando a √°gua pulverizada dentro do condensador.",
                    id='h2ModoCargaList',
                ),
                html.H2(
                    "Na bancada ET 420, o fluido de trabalho vaporizado, comprimido e aquecido no processo, √© resfriado e condensado em um\
                         trocador de calor de feixe de tubos.",               
                    id='h2ModoCarga',
                ),
            ], id='components#fig'),
            #########################################################################
            html.H1(
                "Dep√≥sito de Gelo",
                id='h1NomeComponentes'
            ),
            html.Div([
                html.H2(
                    "A unidade de armazenamento de gelo desempenha um papel crucial na manuten√ß√£o de temperaturas espec√≠ficas, mesmo\
                         em situa√ß√µes de falha no sistema de refrigera√ß√£o. Al√©m disso, atua como componente estrat√©gico para reduzir a\
                             carga m√°xima no sistema, armazenando eficientemente energia de resfriamento. Na configura√ß√£o da bancada, a\
                                 refrigera√ß√£o do armaz√©m de gelo √© mantida por meio de um trocador de calor, onde o refrigerante √© resfriado\
                                     durante o processo de refrigera√ß√£o.",               
                    id='h2ModoCarga',
                ),
                html.Div([
                    html.Img(
                                src="./assets/images/deposito de gelo.webp",
                                id='components#fig',
                            ),
                    html.H5(
                                ["Dep√≥sito de Gelo."], 
                                className="legendaImg",
                                style={
                                    "text-align": "center",
                                },
                            ),
                ], id='ImgComponentes'),
                html.H2(
                    "Ao fornecer energia de resfriamento para congelar a √°gua, a unidade utiliza um tubo em espiral por onde flui a mistura de\
                         glicol-√°gua como meio de armazenamento. Diferentemente do m√©todo de vaporiza√ß√£o direta, onde o refrigerante passa\
                             diretamente pelo tubo em espiral, a vaporiza√ß√£o ocorre de maneira indireta. Durante o processo de descarregamento,\
                                 a transfer√™ncia de calor se d√° diretamente do gelo para a mistura de glicol-√°gua que flui pelo tubo em espiral.\
                                     Devido √† m√° condu√ß√£o t√©rmica do gelo, o desempenho diminui com o aumento da espessura do gelo, resultando\
                                         em um certo grau de autorregula√ß√£o contra o congelamento completo.",               
                    id='h2ModoCarga',
                ),
            ], id='components#fig'),
            ########################################################################
            html.H1(
                "Evaporador",
                id='h1NomeComponentes'
            ),
            html.Div([
                html.H2(
                    "No ciclo de refrigera√ß√£o, o evaporador √© um dos quatro principais componentes do sistema, junto com o compressor,\
                         condensador e v√°lvula de expans√£o. Sua fun√ß√£o √© absorver o calor do ambiente a ser refrigerado, seja uma sala,\
                             compartimento de um refrigerador dom√©stico ou uma se√ß√£o de um sistema de ar condicionado.",               
                    id='h2ModoCarga',
                ),
                html.Div([
                    html.Img(
                                src="./assets/images/evaporador.png",
                                id='components#fig',
                            ),
                    html.H5(
                                ["Evaporador."], 
                                className="legendaImg",
                                style={
                                    "text-align": "center",
                                },
                            ),
                ], id='ImgComponentes'),
                html.H2(
                    "O processo b√°sico de funcionamento do evaporador em um ciclo de refrigera√ß√£o √© o seguinte:",               
                    id='h2ModoCarga',
                ),
                html.H2(
                    "Recebimento de refrigerante l√≠quido: o evaporador recebe refrigerante l√≠quido de baixa press√£o e baixa temperatura da\
                         v√°lvula de expans√£o, ap√≥s passar pelo condensador onde liberou calor para o ambiente externo;",               
                    id='h2ModoCargaList',
                ),
                html.H2(
                    "Absor√ß√£o de calor: o refrigerante l√≠quido entra no evaporador e entra em contato direto com o ambiente a ser resfriado.\
                         √Ä medida que circula pelo evaporador, absorve o calor do ambiente, causando sua evapora√ß√£o;",                
                    id='h2ModoCargaList',
                ),
                html.H2(
                    "Mudan√ßa de estado: durante a absor√ß√£o de calor, o refrigerante l√≠quido muda de estado para vapor de baixa press√£o,\
                         sendo aspirado de volta para o compressor;",
                    id='h2ModoCargaList',
                ),
                html.H2(
                    "Retorno ao compressor: o vapor refrigerante de baixa press√£o √© aspirado pelo compressor, onde √© comprimido para aumentar\
                         sua press√£o e temperatura, reiniciando o ciclo.",
                    id='h2ModoCargaList',
                ),
                html.H2(
                    "O evaporador √© geralmente um trocador de calor do tipo serpentina ou aletado, projetado para maximizar a transfer√™ncia\
                         de calor entre o refrigerante e o ar ou l√≠quido que est√° sendo resfriado. √â uma pe√ßa essencial para o funcionamento\
                             eficiente do sistema de refrigera√ß√£o ou ar condicionado, pois √© onde ocorre a remo√ß√£o eficaz do calor do ambiente\
                                 que est√° sendo refrigerado.",               
                    id='h2ModoCarga',
                ),
            ], id='components#fig'),
            ####################################################################
            html.H1(
                "Rot√¢metro",
                id='h1NomeComponentes'
            ),
            html.Div([
                html.H2(
                    "O rot√¢metro, conhecido como medidor de vaz√£o de √°rea vari√°vel, √© um dispositivo utilizado para medir o fluxo de um\
                         fluido em um sistema. Ele √© composto por um tubo transparente vertical com uma √°rea de se√ß√£o transversal vari√°vel,\
                             onde o fluido entra e causa o deslocamento de um flutuador ou esfera dentro do tubo. A altura do flutuador ou\
                                 esfera √© proporcional ao fluxo do fluido.",               
                    id='h2ModoCarga',
                ),
                html.Div([
                    html.Img(
                                src="./assets/images/rotometro.png",
                                id='components#fig',
                            ),
                    html.H5(
                                ["Rot√¢metros."], 
                                className="legendaImg",
                                style={
                                    "text-align": "center",
                                },
                            ),
                ], id='ImgComponentes'),
                html.H2(
                    "Sua principal caracter√≠stica √© a capacidade de indicar visualmente a taxa de fluxo, pois o flutuador ou esfera se movem\
                         para cima ou para baixo conforme o fluxo varia. Geralmente, uma escala graduada ao longo do tubo permite que o operador\
                             leia a taxa de fluxo diretamente.",               
                    id='h2ModoCarga',
                ),
                html.H2(
                    "Os rot√¢metros s√£o utilizados em uma variedade de aplica√ß√µes industriais, laboratoriais e de processos, onde a medi√ß√£o\
                         precisa do fluxo de l√≠quidos ou gases √© essencial. No entanto, √© importante notar que eles t√™m limita√ß√µes em termos\
                             de precis√£o, especialmente em condi√ß√µes de fluxo turbulento ou pulsante.",               
                    id='h2ModoCarga',
                ),
                html.H2(
                    "Na bancada ET 420, os seguintes rot√¢metros s√£o utilizados:",               
                    id='h2ModoCarga',
                ),
                html.H2(
                    "F1: Medi√ß√£o da vaz√£o do fluido refrigerante R134A no ciclo de refrigera√ß√£o;",               
                    id='h2ModoCargaList',
                ),
                html.H2(
                    "F2: Medi√ß√£o da vaz√£o da mistura √°gua-propilenoglicol depois do est√°gio intermedi√°rio ùêµ2 que vai para a torre de resfriamento seca;",                
                    id='h2ModoCargaList',
                ),
                html.H2(
                    "F3: Medi√ß√£o da vaz√£o da mistura √°gua-propilenoglicol que passa pelo trocador de calor ùëä6;",
                    id='h2ModoCargaList',
                ),
                html.H2(
                    "F4: Medi√ß√£o da vaz√£o da mistura √°gua-propilenoglicol antes do est√°gio intermedi√°rio, fluido que passa pelo trocador de calor de casco e tubo ùëä7;",
                    id='h2ModoCargaList',
                ),
                html.H2(
                    "F5: Medi√ß√£o da vaz√£o da mistura √°gua-propilenoglicol depois do est√°gio intermedi√°rio que vai para a torre de resfriamento √∫mida.",
                    id='h2ModoCargaList',
                ),
            ], id='components#fig'),
            #########################################################################
            html.H1(
                "Torre de Resfriamento",
                id='h1NomeComponentes'
            ),
            html.Div([
                html.H2(
                    "As torres de resfriamento desempenham um papel fundamental na dissipa√ß√£o de calor da √°gua em diversos sistemas,\
                         como usinas de gera√ß√£o de energia, sistemas de refrigera√ß√£o e trocadores de calor. Elas s√£o projetadas para resfriar\
                             a √°gua de forma eficiente, permitindo sua reutiliza√ß√£o e proporcionando benef√≠cios ambientais e econ√¥micos.",               
                    id='h2ModoCarga',
                ),
                html.H2(
                    "Na torre de resfriamento, a √°gua quente entra na parte superior e percorre a estrutura, trocando calor e massa com o ar.\
                         Isso resulta na evapora√ß√£o parcial da √°gua, o que proporciona o resfriamento desejado. Um ventilador localizado no\
                             topo da torre remove o ar saturado, contribuindo para o processo de resfriamento. A efici√™ncia da transfer√™ncia\
                                 de calor depende da diferen√ßa de temperatura entre a √°gua e o ar ambiente.",               
                    id='h2ModoCarga',
                ),
                html.H2(
                    "A configura√ß√£o da bancada permite a integra√ß√£o de torres de resfriamento √∫mido ou a seco no circuito de est√°gio\
                         intermedi√°rio. Essas torres t√™m a capacidade de tanto aquecer quanto retirar calor da mistura utilizada no sistema,\
                             oferecendo flexibilidade operacional.",               
                    id='h2ModoCarga',
                ),
                html.H2(
                    "Torre de Resfriamento a Seco",
                    id='h1NomeComponentesTorres'
                ),
                html.Div([
                    html.Img(
                                src="./assets/images/tore_seca (1).png",
                                id='components#fig',
                            ),
                    html.H5(
                                ["Torre de Resfriamento a Seco."], 
                                className="legendaImg",
                                style={
                                    "text-align": "center",
                                },
                            ),
                ], id='ImgComponentes'),
                html.H2(
                    "As torres de resfriamento a seco operam em circuito fechado, isolando o fluido de resfriamento do ar ambiente.\
                         A transfer√™ncia de calor ocorre por convec√ß√£o, sem envolver evapora√ß√£o.",               
                    id='h2ModoCarga',
                ),
                html.H2(
                    "Torre de Resfriamento √ömido",
                    id='h1NomeComponentesTorres'
                ),
                html.Div([
                    html.Img(
                                src="./assets/images/torre_umida.png",
                                id='components#fig',
                            ),
                    html.H5(
                                ["Torre de Resfriamento √ömido."], 
                                className="legendaImg",
                                style={
                                    "text-align": "center",
                                },
                            ),
                ], id='ImgComponentes'),
                html.H2(
                    "J√° as torres de resfriamento √∫mido operam em um circuito aberto, permitindo que a √°gua quente seja resfriada abaixo\
                         da temperatura de bulbo seco do ar ambiente, especialmente em condi√ß√µes de ar seco.",               
                    id='h2ModoCarga',
                ),
            ], id='components#fig'), 
            ###########################################################################
            html.H1(
                "V√°lvula de Expans√£o",
                id='h1NomeComponentes'
            ),
            html.Div([
                html.H2(
                    "A v√°lvula de expans√£o desempenha um papel fundamental no ciclo de refrigera√ß√£o, regulando o fluxo de refrigerante l√≠quido\
                         para o evaporador, onde ocorre a absor√ß√£o de calor do ambiente a ser resfriado. Sua fun√ß√£o √© controlar a taxa de fluxo\
                             de refrigerante l√≠quido que entra no evaporador, mantendo press√£o e temperatura adequadas para otimizar a \
                                transfer√™ncia de calor. Isso √© essencial para garantir a efici√™ncia do ciclo de refrigera√ß√£o.",               
                    id='h2ModoCarga',
                ),
                html.Div([
                    html.Img(
                                src="./assets/images/valvula.png",
                                id='components#fig',
                            ),
                    html.H5(
                                ["V√°lvula de Expans√£o."], 
                                className="legendaImg",
                                style={
                                    "text-align": "center",
                                },
                            ),
                ], id='ImgComponentes'),
                html.H2(
                    "Existem diferentes tipos de v√°lvulas de expans√£o:",               
                    id='h2ModoCarga',
                ),
                html.H2(
                    "V√°lvula de expans√£o termost√°tica (TXV): controlada pela temperatura do refrigerante no evaporador, ajusta o fluxo de \
                        refrigerante conforme necess√°rio.",               
                    id='h2ModoCargaList',
                ),
                html.H2(
                    "V√°lvula de expans√£o eletr√¥nica (EEV): controlada eletronicamente, ajusta continuamente o fluxo com base em dados de\
                         temperatura e press√£o do sistema.",                
                    id='h2ModoCargaList',
                ),
                html.H2(
                    "V√°lvula de expans√£o manual: ajustada manualmente para controlar o fluxo de refrigerante, sendo menos comum\
                         em sistemas modernos.",
                    id='h2ModoCargaList',
                ),
                html.H2(
                    "Na bancada de refriger√ß√£o, √© utilizada uma v√°lvula de expans√£o termost√°tica que regula o fluxo com base na temperatura\
                         de sa√≠da do evaporador, medida por um sensor de temperatura. Isso evita que o refrigerante n√£o vaporizado entre no\
                             compressor, prevenindo danos ao sistema. √â importante observar que, nos diagramas da bancada, v√°rias v√°lvulas com\
                                 fun√ß√µes distintas s√£o representadas, mas na bancada ET 420 h√° apenas uma v√°lvula de expans√£o no circuito de\
                                     refrigera√ß√£o, indicada como V8.",
                    id='h2ModoCarga',
                ),
            ], id='components#fig'),
            #####################################################################
            html.Br(),
            html.H2(
                    "Ficou com d√∫vida sobre algum componente ou sobre seu funcionamento?  Deseja entender melhor as configura√ß√µes da bancada de refrigera√ß√£o?",               
                    id='h2ModoCarga',
            ),
            html.H2(
                    "Para mais informa√ß√µes referente aos componentes apresentados e sobre a Bancada de Refrigera√ß√£o ET 420. \nVisite: ",               
                    id='h2ModoCarga',
            ),
            html.A("Manual de Uso - Acumulador de Gelo e Refrigera√ß√£o ET 420", href='https://plot.ly', target="_blank", id='linkModoCarga'),
        ], style={'width': '100%'}, id='layout_index_cards'),
        #se√ß√£o logos
        # #logomarcas
        html.Div([
            html.Div([
                html.H2(
                    "Dashboard desenvolvido para a atividade 1 da disciplina de M√°quinas T√©rmicas.",
                    id='dash_press_txt2_station',
                    className="subtitle padded",
                ),
            ])          
        ], style={'border-top': '5px blue solid',
                    'width': '100%',
                    'float': 'left',
                    'margin-top': '40px',
                    'border-radius': '8px',
                    'background': 'lightgray'}),
    ],   id='page-content'),
])


@app.callback(Output('page-content', 'children', allow_duplicate=True),
                Input('buttonHome', 'n_clicks'),
                prevent_initial_call = True)
def display_page(clicks):
    
    if clicks > 0:
        pyautogui.press('f5')
    else:
        raise PreventUpdate